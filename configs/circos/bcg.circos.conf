<<include my_etc/colors_fonts_patterns.conf>>

<<include my_etc/ideogram.conf>>
<<include my_etc/ticks.conf>>

<image>
<<include etc/image.conf>>
</image>

karyotype   = ./data/cell_types/ccr5.cell_type-chr3.txt

chromosomes_units           = 100000000
chromosomes_order           = CD45,M,L,CD8,Naive_CD8,CM_CD8,EM_CD8,RApR7n_EM_CD8,RAnR7n_EM_CD8,CD4,RApR7p,RAnR7p,nTreg,mTreg,TEM,RApR7n,RAnR7n
chromosomes_display_default = yes
#chromosomes       = ct01;ct02
#chromosomes_reverse = ct02

################################################################
# 
# define 2 scatter plots, using the same data file
#

<plots>

# all are scatter plots

type             = scatter
stroke_thickness = 1

# first plot shows all points and selectively formats points at small/large
# y-axis values to be red/green and triangles/rectangles

<plot>

file             = /home/umcg-zzhang/Documents/projects/wp_hiv_ccr5/outputs/age_gender/integration/circos/snp_density/bcg.ccr5_exp.gm.1e-3.ssv
glyph            = circle
glyph_size       = 10

max   = -3 
min   = -20
r1    = .75r
r0    = .55r

# optional y0/y1 values (absolute or relative) in <background> blocks
# define the start/end limits of background color
#
# y0 = 0.006
# y0 = 0.75r

<backgrounds>
<background>
color     = vvlred
</background>
</backgrounds>

<axes>
<axis>
color     = black
position  = eval(log10(5e-8))
#spacing   = 0.25r
thickness = 1
</axis>

</axes>

<rules>
<rule>
#condition    = 1
condition    = var(value) >= 5e-8
value        = eval(log10(var(value)))
stroke_color = grey
fill_color   = grey
glyph_size   = 6
</rule>

<rule>
condition    = var(value) < 5e-8
value        = eval(log10(var(value)))
stroke_color = red
fill_color   = red
show         = yes
glyph        = circle
glyph_size   = 12
</rule>
</rules>

</plot>

# the second plot is a crop of the first plot, placed outside
# the ideogram circle, showing only points with large y-values

<plot>

file  = /home/umcg-zzhang/Documents/projects/wp_hiv_ccr5/outputs/age_gender/integration/circos/snp_density/bcg.ccr5_exp.pc.1e-3.ssv

max   = 20
min   = 3 
r1    = .95r
r0    = .75r

<backgrounds>
# you can stack backgrounds by using transparent color
<background>
color     = vvlyellow
</background>
</backgrounds>

<axes>
<axis>
color     = black
position  = eval(-log10(5e-8))
#spacing   = 0.25r
thickness = 1
</axis>
</axes>

<rules>
<rule>
#condition    = 1
condition    = var(value) >= 5e-8
value        = eval(-log10(var(value)))
stroke_color = grey
fill_color   = grey
glyph        = circle
glyph_size   = 6
</rule>

<rule>
condition    = var(value) < 5e-8
value        = eval(-log10(var(value)))
stroke_color = red
fill_color   = red
show         = yes
glyph        = circle
glyph_size   = 12
</rule>

</rules>

</plot>

</plots>

<<include etc/housekeeping.conf>>
